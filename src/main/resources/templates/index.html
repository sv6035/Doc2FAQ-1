<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title th:text="${appName}">Doc2FAQ</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        .hero-section {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 100px 0;
        }
        .feature-icon {
            font-size: 3rem;
            color: #667eea;
            margin-bottom: 1rem;
        }
        .footer {
            background-color: #f8f9fa;
            padding: 40px 0;
            margin-top: 50px;
        }
        .upload-area {
            transition: all 0.3s ease;
            cursor: pointer;
        }
        .upload-area:hover {
            background-color: #f8f9ff;
        }
        .upload-area.drag-over {
            background-color: #e3f2fd;
            border-color: #2196f3 !important;
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div class="container">
            <a class="navbar-brand" href="#" th:text="${appName}">
                <i class="fas fa-file-alt me-2"></i>Doc2FAQ
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link active" href="#">Home</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#">Features</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#">About</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section class="hero-section text-center">
        <div class="container">
            <div class="row">
                <div class="col-lg-8 mx-auto">
                    <h1 class="display-4 fw-bold mb-4" th:text="${appName}">Doc2FAQ</h1>
                    <p class="lead mb-4" th:text="${appDescription}">
                        Transform your documents into comprehensive FAQ formats with ease. 
                        Upload documents and let our intelligent system generate relevant questions and answers.
                    </p>
                    <div class="d-grid gap-2 d-md-flex justify-content-md-center">
                        <button class="btn btn-light btn-lg px-4 me-md-2" type="button" onclick="scrollToUpload()">
                            <i class="fas fa-upload me-2"></i>Get Started
                        </button>
                        <button class="btn btn-outline-light btn-lg px-4" type="button" onclick="scrollToFeatures()">
                            <i class="fas fa-info-circle me-2"></i>Learn More
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- File Upload Section -->
    <section id="upload-section" class="py-5 bg-light">
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-lg-8">
                    <div class="text-center mb-5">
                        <h2 class="display-6 fw-bold text-primary">
                            <i class="fas fa-cloud-upload-alt me-3"></i>Upload Your Document
                        </h2>
                        <p class="lead text-muted">
                            Upload your PDF, DOCX, or TXT files to generate comprehensive FAQs. 
                            Maximum file size: 10 MB.
                        </p>
                    </div>
                    
                    <div class="card shadow-lg border-0">
                        <div class="card-body p-5">
                            <!-- Upload Form -->
                            <form id="uploadForm" enctype="multipart/form-data">
                                <div class="mb-4">
                                    <div class="upload-area border-2 border-dashed border-primary rounded p-4 text-center" 
                                         id="uploadArea" 
                                         ondrop="dropHandler(event);" 
                                         ondragover="dragOverHandler(event);" 
                                         ondragleave="dragLeaveHandler(event);">
                                        <div class="upload-content">
                                            <i class="fas fa-cloud-upload-alt fa-3x text-primary mb-3"></i>
                                            <h5 class="mb-3">Drag and drop your file here</h5>
                                            <p class="text-muted mb-3">or</p>
                                            <input type="file" 
                                                   id="fileInput" 
                                                   name="file" 
                                                   accept=".pdf,.docx,.txt" 
                                                   class="d-none" 
                                                   onchange="handleFileSelect(event)">
                                            <button type="button" 
                                                    class="btn btn-outline-primary" 
                                                    onclick="document.getElementById('fileInput').click()">
                                                <i class="fas fa-folder-open me-2"></i>Browse Files
                                            </button>
                                            <div class="mt-3">
                                                <small class="text-muted">
                                                    Supported formats: PDF, DOCX, TXT (Max: 10 MB)
                                                </small>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Selected File Info -->
                                <div id="fileInfo" class="mb-4" style="display: none;">
                                    <div class="alert alert-info d-flex align-items-center">
                                        <i class="fas fa-file me-3"></i>
                                        <div class="flex-grow-1">
                                            <strong id="fileName"></strong>
                                            <div class="small text-muted" id="fileSize"></div>
                                        </div>
                                        <button type="button" class="btn-close" onclick="clearFileSelection()"></button>
                                    </div>
                                </div>
                                
                                <!-- Upload Button -->
                                <div class="d-grid">
                                    <button type="submit" 
                                            id="uploadBtn" 
                                            class="btn btn-primary btn-lg" 
                                            disabled>
                                        <i class="fas fa-upload me-2"></i>
                                        <span id="uploadBtnText">Upload Document</span>
                                    </button>
                                </div>
                            </form>
                            
                            <!-- Progress Bar -->
                            <div id="uploadProgress" class="mt-4" style="display: none;">
                                <div class="progress">
                                    <div class="progress-bar progress-bar-striped progress-bar-animated" 
                                         role="progressbar" 
                                         style="width: 0%"></div>
                                </div>
                                <div class="text-center mt-2">
                                    <small class="text-muted">Uploading your document...</small>
                                </div>
                            </div>
                            
                            <!-- Alert Messages -->
                            <div id="alertContainer" class="mt-4"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Features Section -->
    <section id="features-section" class="py-5">
        <div class="container">
            <div class="row text-center">
                <div class="col-lg-4 mb-4">
                    <div class="feature-icon">
                        <i class="fas fa-file-upload"></i>
                    </div>
                    <h4>Easy Upload</h4>
                    <p class="text-muted">Simply upload your documents in various formats and let our system process them automatically.</p>
                </div>
                <div class="col-lg-4 mb-4">
                    <div class="feature-icon">
                        <i class="fas fa-brain"></i>
                    </div>
                    <h4>Smart Processing</h4>
                    <p class="text-muted">Our intelligent algorithms analyze your content and generate relevant questions and answers.</p>
                </div>
                <div class="col-lg-4 mb-4">
                    <div class="feature-icon">
                        <i class="fas fa-download"></i>
                    </div>
                    <h4>Export Results</h4>
                    <p class="text-muted">Download your generated FAQ in multiple formats ready for use in your applications.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Status Section -->
    <section class="bg-light py-4">
        <div class="container">
            <div class="row">
                <div class="col-md-6">
                    <h5><i class="fas fa-info-circle text-primary me-2"></i>Application Status</h5>
                    <p class="mb-0">Version: <span class="badge bg-primary" th:text="${version}">1.0.0-SNAPSHOT</span></p>
                    <p class="mb-0 text-success"><i class="fas fa-check-circle me-1"></i>Application is running successfully</p>
                </div>
                <div class="col-md-6 text-md-end">
                    <h5><i class="fas fa-rocket text-success me-2"></i>Ready for Development</h5>
                    <p class="mb-0">The application is ready to begin adding core features.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="container text-center">
            <div class="row">
                <div class="col-12">
                    <p class="text-muted mb-0">
                        &copy; 2024 <span th:text="${appName}">Doc2FAQ</span>. 
                        Built with <i class="fas fa-heart text-danger"></i> using Spring Boot.
                    </p>
                </div>
            </div>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <script>
        let selectedFile = null;

        // Smooth scrolling functions
        function scrollToUpload() {
            document.getElementById('upload-section').scrollIntoView({ 
                behavior: 'smooth' 
            });
        }

        function scrollToFeatures() {
            document.getElementById('features-section').scrollIntoView({ 
                behavior: 'smooth' 
            });
        }

        // Drag and drop handlers
        function dragOverHandler(ev) {
            ev.preventDefault();
            ev.currentTarget.classList.add('drag-over');
        }

        function dragLeaveHandler(ev) {
            ev.preventDefault();
            ev.currentTarget.classList.remove('drag-over');
        }

        function dropHandler(ev) {
            ev.preventDefault();
            ev.currentTarget.classList.remove('drag-over');
            
            const files = ev.dataTransfer.files;
            if (files.length > 0) {
                handleFile(files[0]);
            }
        }

        // File selection handler
        function handleFileSelect(event) {
            const file = event.target.files[0];
            if (file) {
                handleFile(file);
            }
        }

        // File handling and validation
        function handleFile(file) {
            // Validate file type
            const allowedTypes = ['application/pdf', 'application/vnd.openxmlformats-officedocument.wordprocessingml.document', 'text/plain'];
            const allowedExtensions = ['.pdf', '.docx', '.txt'];
            
            const fileName = file.name.toLowerCase();
            const isValidType = allowedTypes.includes(file.type) || 
                               allowedExtensions.some(ext => fileName.endsWith(ext));
            
            if (!isValidType) {
                showAlert('error', 'Invalid file type. Please select a PDF, DOCX, or TXT file.');
                return;
            }

            // Validate file size (10 MB)
            const maxSize = 10 * 1024 * 1024;
            if (file.size > maxSize) {
                showAlert('error', 'File size exceeds 10 MB limit. Please select a smaller file.');
                return;
            }

            selectedFile = file;
            displayFileInfo(file);
            document.getElementById('uploadBtn').disabled = false;
        }

        // Display selected file information
        function displayFileInfo(file) {
            const fileInfo = document.getElementById('fileInfo');
            const fileName = document.getElementById('fileName');
            const fileSize = document.getElementById('fileSize');
            
            fileName.textContent = file.name;
            fileSize.textContent = formatFileSize(file.size);
            fileInfo.style.display = 'block';
        }

        // Clear file selection
        function clearFileSelection() {
            selectedFile = null;
            document.getElementById('fileInput').value = '';
            document.getElementById('fileInfo').style.display = 'none';
            document.getElementById('uploadBtn').disabled = true;
            clearAlerts();
        }

        // Format file size
        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }

        // Handle form submission
        document.getElementById('uploadForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            if (!selectedFile) {
                showAlert('error', 'Please select a file to upload.');
                return;
            }

            uploadFile();
        });

        // Upload file to server
        function uploadFile() {
            const formData = new FormData();
            formData.append('file', selectedFile);

            const uploadBtn = document.getElementById('uploadBtn');
            const uploadBtnText = document.getElementById('uploadBtnText');
            const uploadProgress = document.getElementById('uploadProgress');
            const progressBar = uploadProgress.querySelector('.progress-bar');

            // Show progress and disable button
            uploadBtn.disabled = true;
            uploadBtnText.textContent = 'Uploading...';
            uploadProgress.style.display = 'block';
            progressBar.style.width = '0%';
            clearAlerts();

            // Simulate progress
            let progress = 0;
            const progressInterval = setInterval(() => {
                progress += Math.random() * 30;
                if (progress > 90) progress = 90;
                progressBar.style.width = progress + '%';
            }, 200);

            // Make AJAX request
            fetch('/api/upload', {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                clearInterval(progressInterval);
                progressBar.style.width = '100%';
                
                setTimeout(() => {
                    uploadProgress.style.display = 'none';
                    
                    if (data.success) {
                        showAlert('success', 
                            `File uploaded successfully! Upload ID: ${data.fileId}`, 
                            data);
                        clearFileSelection();
                    } else {
                        showAlert('error', data.message);
                    }
                    
                    uploadBtn.disabled = false;
                    uploadBtnText.textContent = 'Upload Document';
                }, 500);
            })
            .catch(error => {
                clearInterval(progressInterval);
                uploadProgress.style.display = 'none';
                showAlert('error', 'Upload failed. Please try again.');
                uploadBtn.disabled = false;
                uploadBtnText.textContent = 'Upload Document';
            });
        }

        // Show alert messages
        function showAlert(type, message, data = null) {
            const alertContainer = document.getElementById('alertContainer');
            const alertClass = type === 'success' ? 'alert-success' : 'alert-danger';
            const icon = type === 'success' ? 'fas fa-check-circle' : 'fas fa-exclamation-triangle';
            
            let alertContent = `
                <div class="alert ${alertClass} alert-dismissible fade show" role="alert">
                    <i class="${icon} me-2"></i>
                    <strong>${message}</strong>
            `;
            
            if (data && type === 'success') {
                alertContent += `
                    <div class="mt-2 small">
                        <div><strong>File:</strong> ${data.fileName}</div>
                        <div><strong>Size:</strong> ${formatFileSize(data.fileSize)}</div>
                        <div><strong>Upload ID:</strong> <code>${data.fileId}</code></div>
                    </div>
                `;
            }
            
            alertContent += `
                    <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                </div>
            `;
            
            alertContainer.innerHTML = alertContent;
        }

        // Clear all alerts
        function clearAlerts() {
            document.getElementById('alertContainer').innerHTML = '';
        }

        // Make upload area clickable
        document.getElementById('uploadArea').addEventListener('click', function() {
            document.getElementById('fileInput').click();
        });
    </script>
</body>
</html>